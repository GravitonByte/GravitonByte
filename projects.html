<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Proyectos</title>
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />
    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Press+Start+2P"
      rel="stylesheet"
    />
    <!-- Estilos -->
    <link rel="stylesheet" href="css/projects.css" />
  </head>

  <body>
    <!-- Fondo animado -->
    <canvas id="space"></canvas>

    <header>
      <nav>
        <a href="index.html">Inicio</a>
        <a href="about.html">Sobre mí</a>
        <a href="skills.html">Habilidades</a>
        <a href="projects.html" class="active">Proyectos</a>
        <a href="contact.html">Contacto</a>
      </nav>
    </header>

    <section class="home">
      <div class="home-content">
        <!-- Carrusel de habilidades -->
        <div class="carousel-container">
          <div class="nav-btn prev"><i class="fas fa-chevron-left"></i></div>
          <div class="carousel">
            <div class="carousel-track">
              <!-- Visor médico -->
              <div class="card" data-skill="95">
                <div class="card-inner">
                  <div class="card-front">
                    <div class="card-title">Visor médico</div>
                    <div class="card-image">
                      <img src="assets/icons/icon-html.png" alt="HTML" />
                    </div>
                  </div>
                  <div class="card-back">
                    <div class="progress-container">
                      <svg class="progress-svg" viewBox="0 0 100 100">
                        <circle
                          class="progress-circle-bg"
                          cx="50"
                          cy="50"
                          r="40"
                        />
                        <circle
                          class="progress-circle"
                          cx="50"
                          cy="50"
                          r="40"
                        />
                      </svg>
                      <div class="progress-text">100%</div>
                    </div>
                    <div class="skill-description">
                      Aplicación web para visualizar imagenes médicas.
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="nav-btn next"><i class="fas fa-chevron-right"></i></div>
        </div>
      </div>
    </section>

    <footer>
      <p class="pixel-art">&copy; 2025 GravitonByte</p>
    </footer>

    <!-- Script del fondo animado -->
    <script src="js/space.js"></script>

    <script>
      const track = document.querySelector(".carousel-track");
      const cards = Array.from(track.children);
      const prevButton = document.querySelector(".prev");
      const nextButton = document.querySelector(".next");
      let index = 0;

      // Función para actualizar carrusel
      function updateCarousel() {
        const gap = 20;
        const cardWidth = cards[0].offsetWidth;
        const moveAmount = cardWidth + gap;

        track.style.transform = `translateX(${-index * moveAmount}px)`;

        prevButton.classList.toggle("disabled", index === 0);
        nextButton.classList.toggle(
          "disabled",
          index >= cards.length - getCardsToShow()
        );
      }

      // Cuántas tarjetas mostrar según el tamaño de pantalla real
      function getCardsToShow() {
        const w = window.innerWidth;
        if (w <= 768) return 1;
        if (w <= 1024) return 2;
        return 3;
      }

      // Botón siguiente
      nextButton.addEventListener("click", () => {
        if (index < cards.length - getCardsToShow()) {
          index++;
          updateCarousel();
        }
      });

      // Botón anterior
      prevButton.addEventListener("click", () => {
        if (index > 0) {
          index--;
          updateCarousel();
        }
      });

      // Flip cards y animar progreso
      cards.forEach((card) => {
        const flipCard = () => {
          cards.forEach((c) => c !== card && c.classList.remove("flipped"));
          card.classList.toggle("flipped");

          if (card.classList.contains("flipped")) {
            const skillLevel = parseInt(card.getAttribute("data-skill"));
            const progressCircle = card.querySelector(".progress-circle");
            const circumference = 40 * 2 * Math.PI;
            const offset = circumference - (skillLevel / 100) * circumference;

            setTimeout(() => {
              progressCircle.style.strokeDasharray = `${circumference} ${circumference}`;
              progressCircle.style.strokeDashoffset = offset;

              if (skillLevel <= 30) {
                progressCircle.style.stroke = "#ff6b6b";
              } else if (skillLevel <= 60) {
                progressCircle.style.stroke = "#feca57";
              } else {
                progressCircle.style.stroke = "#44da31";
              }
            }, 100);
          }
        };

        // Click en desktop
        card.addEventListener("click", flipCard);

        // Tocarlo en móviles sin bloquear scroll vertical
        card.addEventListener("touchend", (e) => {
          e.preventDefault();
          flipCard();
        });
      });

      // Recalcular posiciones al redimensionar pantalla
      window.addEventListener("resize", () => {
        index = 0; // Evita quedar fuera de rango tras resize
        updateCarousel();
      });

      // Inicialización
      updateCarousel();
    </script>
  </body>
</html>
